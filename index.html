<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>GEMS API Example</title>

    <link rel="stylesheet" href="gems/gems.css">
    <script src="gems/gems.js"></script>

    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="frame">
        <h2>Score:&nbsp;<span id="score">0</span></h2>
        <button id="start" onclick="start()">Start the game</button>
        <div>
        <button disabled id="play" onclick="score()">Score&nbsp;</button>
        <input disabled id="scorebox" type="number" value="10"/>&nbsp; points
        </div>
    <button disabled id="finish" onclick="finish()">Finish the game</button>
    </div>
    <script>
        // init and first event
        const apiKey = "i2slulN)U%7xvMoVACLSEYogOekNQoWE";
        const appId = "37675ac8-c0c0-42e9-8291-0f9529df5d47";
        GEMS.init(apiKey, appId);
        GEMS.initUser().then(()=>{
            GEMS.event("Demo-GamePage");
        });

        // game logic   
        const scoreSpan = document.querySelector("#score");
        const startButton = document.querySelector("#start");
        const playButton = document.querySelector("#play");
        const scoreBox = document.querySelector("#scorebox");
        const finishButton = document.querySelector("#finish");

        function start() {
            GEMS.event("Demo-GameStarted");
            scoreSpan.innerText = "0";
            playButton.disabled = false;
            scoreBox.disabled = false;
        }

        function score() {
            let n = Number(scoreSpan.innerText);
            let nNew = Number(scoreBox.value);
            if (isNaN(nNew)){
                nNew = 0;
            }
            n += nNew;
            scoreSpan.innerText = String(n);
            finishButton.disabled = false;
        }

        function finish() {
            GEMS.event("Demo-GameFinished", {value:Number(scoreSpan.innerText)});
            playButton.disabled = true;
            scoreBox.disabled = true;
            finishButton.disabled = true;
        }
    </script>
</body>
</html>